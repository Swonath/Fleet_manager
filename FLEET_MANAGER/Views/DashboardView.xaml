<UserControl x:Class="FLEET_MANAGER.Views.DashboardView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:FLEET_MANAGER.Views"
             Background="{StaticResource BackgroundBrush}">
	<UserControl.Resources>
		<local:InverseBoolToVisibilityConverter x:Key="InverseBoolToVisibilityConverter"/>
	</UserControl.Resources>
	<Grid Margin="32">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>

		<!-- Indicateur de chargement -->
		<Border Grid.Row="1"
		        Background="#F8FAFC"
		        CornerRadius="12"
		        Padding="40"
		        HorizontalAlignment="Center"
		        VerticalAlignment="Center"
		        Visibility="{Binding EstEnChargement, Converter={StaticResource BoolToVisibilityConverter}}">
			<StackPanel HorizontalAlignment="Center">
				<TextBlock Text="‚è≥"
				           FontSize="48"
				           HorizontalAlignment="Center"
				           Margin="0,0,0,16"/>
				<TextBlock Text="Chargement des donn√©es..."
				           FontSize="16"
				           FontWeight="Medium"
				           Foreground="{StaticResource TextSecondaryBrush}"
				           HorizontalAlignment="Center"/>
			</StackPanel>
		</Border>

		<!-- Header -->
		<StackPanel Grid.Row="0" Style="{StaticResource PageHeaderStyle}" Margin="0,0,0,32">
			<TextBlock Style="{StaticResource PageTitleStyle}">
				Tableau de Bord
			</TextBlock>
			<TextBlock Style="{StaticResource PageDescriptionStyle}">
				Vue d'ensemble de votre flotte de v√©hicules
			</TextBlock>
		</StackPanel>

		<!-- Contenu principal -->
		<ScrollViewer Grid.Row="1"
		              VerticalScrollBarVisibility="Auto"
		              HorizontalScrollBarVisibility="Disabled"
		              Margin="0,0,8,0">
			<StackPanel Margin="0,0,8,0">
				<!-- Statistiques -->
				<Border Style="{StaticResource CardStyle}" Margin="0,0,0,24">
					<Grid>
						<Grid.RowDefinitions>
							<RowDefinition Height="Auto"/>
							<RowDefinition Height="Auto"/>
						</Grid.RowDefinitions>

						<TextBlock Grid.Row="0"
						           Text="üìä Vue d'ensemble"
						           Style="{StaticResource SectionTitleStyle}"
						           Margin="0,0,0,20"/>

						<Grid Grid.Row="1">
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="*"/>
								<ColumnDefinition Width="*"/>
								<ColumnDefinition Width="*"/>
								<ColumnDefinition Width="*"/>
								<ColumnDefinition Width="*"/>
							</Grid.ColumnDefinitions>

							<!-- Bloc 1: Total V√©hicules -->
							<Border Grid.Column="0" Style="{StaticResource StatBoxStyle}">
						<StackPanel>
							<TextBlock Style="{StaticResource StatLabelStyle}">
								Total V√©hicules
							</TextBlock>
							<TextBlock Text="{Binding TotalVehicules}"
									   FontSize="36"
									   FontWeight="Bold"
									   Foreground="{StaticResource PrimaryBrush}"
									   Margin="0,8,0,0"/>
							<TextBlock Text="V√©hicules"
									   FontSize="12"
									   Foreground="{StaticResource TextSecondaryBrush}"
									   Margin="0,4,0,0"/>
						</StackPanel>
					</Border>

					<!-- Bloc 2: En Service -->
					<Border Grid.Column="1" Style="{StaticResource StatBoxStyle}" Margin="12,0,0,0">
						<StackPanel>
							<TextBlock Style="{StaticResource StatLabelStyle}">
								En Service
							</TextBlock>
							<TextBlock Text="{Binding VehiculesEnService}"
									   FontSize="36"
									   FontWeight="Bold"
									   Foreground="{StaticResource SuccessBrush}"
									   Margin="0,8,0,0"/>
							<TextBlock Text="Actifs"
									   FontSize="12"
									   Foreground="{StaticResource TextSecondaryBrush}"
									   Margin="0,4,0,0"/>
						</StackPanel>
					</Border>

					<!-- Bloc 3: En Maintenance -->
					<Border Grid.Column="2" Style="{StaticResource StatBoxStyle}" Margin="12,0,0,0">
						<StackPanel>
							<TextBlock Style="{StaticResource StatLabelStyle}">
								En Maintenance
							</TextBlock>
							<TextBlock Text="{Binding VehiculesEnMaintenance}"
									   FontSize="36"
									   FontWeight="Bold"
									   Foreground="{StaticResource WarningBrush}"
									   Margin="0,8,0,0"/>
							<TextBlock Text="R√©vision"
									   FontSize="12"
									   Foreground="{StaticResource TextSecondaryBrush}"
									   Margin="0,4,0,0"/>
						</StackPanel>
					</Border>

					<!-- Bloc 4: Disponible -->
					<Border Grid.Column="3" Style="{StaticResource StatBoxStyle}" Margin="12,0,0,0">
						<StackPanel>
							<TextBlock Style="{StaticResource StatLabelStyle}">
								Disponible
							</TextBlock>
							<TextBlock Text="{Binding VehiculesDisponibles}"
									   FontSize="36"
									   FontWeight="Bold"
									   Foreground="{StaticResource InfoBrush}"
									   Margin="0,8,0,0"/>
							<TextBlock Text="Libres"
									   FontSize="12"
									   Foreground="{StaticResource TextSecondaryBrush}"
									   Margin="0,4,0,0"/>
						</StackPanel>
					</Border>

					<!-- Bloc 5: Co√ªt Total Carburant -->
					<Border Grid.Column="4" Style="{StaticResource StatBoxStyle}" Margin="12,0,0,0">
						<StackPanel>
							<TextBlock Style="{StaticResource StatLabelStyle}">
								Co√ªt Essence
							</TextBlock>
							<TextBlock Text="{Binding CoutTotalCarburant, StringFormat=C}"
									   FontSize="32"
									   FontWeight="Bold"
									   Foreground="{StaticResource DangerBrush}"
									   Margin="0,8,0,0"/>
							<TextBlock Text="Total"
									   FontSize="12"
									   Foreground="{StaticResource TextSecondaryBrush}"
									   Margin="0,4,0,0"/>
						</StackPanel>
					</Border>
						</Grid>
					</Grid>
				</Border>

				<!-- Liste des v√©hicules -->
				<Border Style="{StaticResource CardStyle}">
					<Grid>
						<Grid.RowDefinitions>
							<RowDefinition Height="Auto"/>
							<RowDefinition Height="Auto"/>
							<RowDefinition Height="*"/>
						</Grid.RowDefinitions>

						<TextBlock Grid.Row="0"
						           Text="üöó Tous les V√©hicules"
						           Style="{StaticResource SectionTitleStyle}"/>

						<TextBlock Grid.Row="1" Style="{StaticResource SubtitleStyle}">
							<Run Text="{Binding Vehicules.Count, Mode=OneWay}"/>
							<Run Text="v√©hicules enregistr√©s"/>
						</TextBlock>

						<!-- Grille de cartes de v√©hicules -->
						<StackPanel Grid.Row="2" Margin="0,8,0,0">
							<ItemsControl ItemsSource="{Binding Vehicules}"
							              MaxHeight="500"
							              ScrollViewer.VerticalScrollBarVisibility="Disabled">
								<ItemsControl.ItemsPanel>
									<ItemsPanelTemplate>
										<WrapPanel Orientation="Horizontal"/>
									</ItemsPanelTemplate>
								</ItemsControl.ItemsPanel>
								<ItemsControl.ItemTemplate>
									<DataTemplate>
										<Border Background="White"
										        BorderBrush="{StaticResource BorderBrush}"
										        BorderThickness="1"
										        CornerRadius="12"
										        Padding="20"
										        Margin="0,0,16,16"
										        Width="340">
											<Border.Effect>
												<DropShadowEffect Color="#E2E8F0" BlurRadius="8" ShadowDepth="2" Opacity="0.15"/>
											</Border.Effect>
											<Grid>
												<Grid.RowDefinitions>
													<RowDefinition Height="Auto"/>
													<RowDefinition Height="Auto"/>
													<RowDefinition Height="Auto"/>
												</Grid.RowDefinitions>

												<!-- Ent√™te avec ic√¥ne -->
												<Grid Grid.Row="0" Margin="0,0,0,16">
													<Grid.ColumnDefinitions>
														<ColumnDefinition Width="Auto"/>
														<ColumnDefinition Width="*"/>
													</Grid.ColumnDefinitions>

													<Border Grid.Column="0"
													        Width="56"
													        Height="56"
													        CornerRadius="12"
													        Background="{StaticResource PrimaryLightBrush}"
													        VerticalAlignment="Top">
														<TextBlock Text="üöó"
														           FontSize="28"
														           HorizontalAlignment="Center"
														           VerticalAlignment="Center"/>
													</Border>

													<StackPanel Grid.Column="1" Margin="16,0,0,0">
														<TextBlock Text="{Binding Marque}"
														           FontSize="18"
														           FontWeight="Bold"
														           Foreground="{StaticResource TextPrimaryBrush}"/>
														<TextBlock Text="{Binding Modele}"
														           FontSize="14"
														           Foreground="{StaticResource TextSecondaryBrush}"
														           Margin="0,2,0,0"/>
													</StackPanel>
												</Grid>

												<!-- Informations -->
												<StackPanel Grid.Row="1" Margin="0,0,0,12">
													<!-- Immatriculation -->
													<Border Background="{StaticResource BackgroundBrush}"
													        CornerRadius="6"
													        Padding="12,8"
													        Margin="0,0,0,8">
														<Grid>
															<Grid.ColumnDefinitions>
																<ColumnDefinition Width="*"/>
																<ColumnDefinition Width="Auto"/>
															</Grid.ColumnDefinitions>
															<TextBlock Grid.Column="0"
															           Text="Immatriculation"
															           FontSize="11"
															           Foreground="{StaticResource TextSecondaryBrush}"/>
															<TextBlock Grid.Column="1"
															           Text="{Binding Immatriculation}"
															           FontSize="13"
															           FontWeight="SemiBold"
															           Foreground="{StaticResource TextPrimaryBrush}"/>
														</Grid>
													</Border>

													<!-- Ann√©e et Type -->
													<Grid Margin="0,0,0,8">
														<Grid.ColumnDefinitions>
															<ColumnDefinition Width="*"/>
															<ColumnDefinition Width="*"/>
														</Grid.ColumnDefinitions>

														<Border Grid.Column="0"
														        Background="{StaticResource BackgroundBrush}"
														        CornerRadius="6"
														        Padding="12,8"
														        Margin="0,0,4,0">
															<StackPanel>
																<TextBlock Text="Ann√©e"
																           FontSize="11"
																           Foreground="{StaticResource TextSecondaryBrush}"/>
																<TextBlock Text="{Binding AnneeFabrication}"
																           FontSize="13"
																           FontWeight="SemiBold"
																           Foreground="{StaticResource TextPrimaryBrush}"
																           Margin="0,2,0,0"/>
															</StackPanel>
														</Border>

														<Border Grid.Column="1"
														        Background="{StaticResource BackgroundBrush}"
														        CornerRadius="6"
														        Padding="12,8"
														        Margin="4,0,0,0">
															<StackPanel>
																<TextBlock Text="Carburant"
																           FontSize="11"
																           Foreground="{StaticResource TextSecondaryBrush}"/>
																<TextBlock Text="{Binding TypeCarburant}"
																           FontSize="13"
																           FontWeight="SemiBold"
																           Foreground="{StaticResource TextPrimaryBrush}"
																           Margin="0,2,0,0"/>
															</StackPanel>
														</Border>
													</Grid>

													<!-- Kilom√©trage -->
													<Border Background="{StaticResource BackgroundBrush}"
													        CornerRadius="6"
													        Padding="12,8">
														<Grid>
															<Grid.ColumnDefinitions>
																<ColumnDefinition Width="*"/>
																<ColumnDefinition Width="Auto"/>
															</Grid.ColumnDefinitions>
															<TextBlock Grid.Column="0"
															           Text="Kilom√©trage actuel"
															           FontSize="11"
															           Foreground="{StaticResource TextSecondaryBrush}"/>
															<TextBlock Grid.Column="1"
															           Text="{Binding KilomettrageActuel, StringFormat={}{0:N0} km}"
															           FontSize="13"
															           FontWeight="Bold"
															           Foreground="{StaticResource PrimaryBrush}"/>
														</Grid>
													</Border>
												</StackPanel>

												<!-- Badge √âtat -->
												<Grid Grid.Row="2">
													<Border CornerRadius="8"
													        Padding="12,6"
													        HorizontalAlignment="Stretch">
														<Border.Style>
															<Style TargetType="Border">
																<Style.Triggers>
																	<DataTrigger Binding="{Binding Etat}" Value="En service">
																		<Setter Property="Background" Value="{StaticResource SuccessLightBrush}"/>
																	</DataTrigger>
																	<DataTrigger Binding="{Binding Etat}" Value="En maintenance">
																		<Setter Property="Background" Value="{StaticResource WarningLightBrush}"/>
																	</DataTrigger>
																	<DataTrigger Binding="{Binding Etat}" Value="Disponible">
																		<Setter Property="Background" Value="{StaticResource InfoLightBrush}"/>
																	</DataTrigger>
																</Style.Triggers>
															</Style>
														</Border.Style>
														<TextBlock Text="{Binding Etat}"
														           FontSize="12"
														           FontWeight="SemiBold"
														           HorizontalAlignment="Center">
															<TextBlock.Style>
																<Style TargetType="TextBlock">
																	<Style.Triggers>
																		<DataTrigger Binding="{Binding Etat}" Value="En service">
																			<Setter Property="Foreground" Value="{StaticResource SuccessBrush}"/>
																		</DataTrigger>
																		<DataTrigger Binding="{Binding Etat}" Value="En maintenance">
																			<Setter Property="Foreground" Value="{StaticResource WarningBrush}"/>
																		</DataTrigger>
																		<DataTrigger Binding="{Binding Etat}" Value="Disponible">
																			<Setter Property="Foreground" Value="{StaticResource InfoBrush}"/>
																		</DataTrigger>
																	</Style.Triggers>
																</Style>
															</TextBlock.Style>
														</TextBlock>
													</Border>
												</Grid>
											</Grid>
										</Border>
									</DataTemplate>
								</ItemsControl.ItemTemplate>
							</ItemsControl>

							<!-- Bouton Voir Plus -->
							<Button Command="{Binding ChargerPlusCommand}"
							        Style="{StaticResource SecondaryButtonStyle}"
							        Height="45"
							        Margin="0,24,0,0"
							        HorizontalAlignment="Center"
							        Padding="40,0">
								<Button.Visibility>
									<Binding Path="TousVehiculesCharges">
										<Binding.Converter>
											<local:InverseBoolToVisibilityConverter/>
										</Binding.Converter>
									</Binding>
								</Button.Visibility>
								<StackPanel Orientation="Horizontal">
									<TextBlock Text="üëá" FontSize="16" Margin="0,0,8,0"/>
									<TextBlock Text="Voir plus de v√©hicules" FontSize="14" FontWeight="Medium"/>
								</StackPanel>
							</Button>

							<!-- Message fin de liste -->
							<Border Background="{StaticResource BackgroundBrush}"
							        CornerRadius="8"
							        Padding="16"
							        Margin="0,24,0,0"
							        HorizontalAlignment="Center"
							        Visibility="{Binding TousVehiculesCharges, Converter={StaticResource BoolToVisibilityConverter}}">
								<TextBlock Text="‚úÖ Tous les v√©hicules sont affich√©s"
								           FontSize="13"
								           Foreground="{StaticResource TextSecondaryBrush}"/>
							</Border>
						</StackPanel>
					</Grid>
				</Border>
			</StackPanel>
		</ScrollViewer>
	</Grid>
</UserControl>
